(()=>{var s={790:(s,e,t)=>{const r=t(860),a=t(0),o=t(710),n=t(17);s.exports=(new class{constructor(){this.app=r(),this.middlewares()}middlewares(){this.app.use(r.json()),this.app.use(a),this.app.use(o()),this.app.use(r.static(n.join(__dirname,"public"))),this.app.set("view engine","ejs"),this.app.set("views",n.resolve(__dirname,"./views"))}}).app},73:(s,e,t)=>{const{user:r}=t(44);var a=t(432);const{StatusCodes:o}=t(10);s.exports=new class{async getAll(s,e){try{const s=await r.findAll();return e.status(o.OK).json(s)}catch(s){return console.log(s),e.status(o.INTERNAL_SERVER_ERROR).json(s)}}async getByEmail(s,e){const t=s.body.email;try{const s=await r.findOne({where:{email:t}});return s?e.status(o.OK).json(s):e.status(o.BAD_REQUEST).json({msg:"User not found"})}catch(s){return console.log(s),e.status(o.INTERNAL_SERVER_ERROR).json(s)}}async create(s,e){const{name:t,email:a,password:n,provider:i}=s.body;try{const s=await r.create({name:t,email:a,password:n,provider:i});return e.status(o.OK).json(s)}catch(s){return e.status(o.BAD_REQUEST).json(s)}}async update(s,e){const{name:t,email:n,password:i,provider:c}=s.body;try{const s=await r.findOne({where:{email:n}});if(console.log(s.password_hash),console.log(i),await a.compare(i,s.password_hash))return await s.update({name:t,password:i,provider:c}),e.status(o.OK).json(s);throw new Error("Invalid Password")}catch(s){return console.log(s),e.status(o.BAD_REQUEST).json({error:s})}}}},613:(s,e,t)=>{const{user:r}=t(44),{StatusCodes:a}=(t(344),t(432),t(10));t(113),t(529),s.exports=new class{async register(s,e){e.status(a.OK).render("login")}async authenticate(s,e){try{const{email:e,password:t}=s.body;if(console.log(s.originalUrl),!await r.findOne({where:{email:e}}))throw{msg:"user not found",cod:0}}catch(s){e.status(a.BAD_REQUEST).json(s)}}async update(s,e){}}},44:(s,e,t)=>{"use strict";const r=t(147),a=t(17),o=t(496),n=a.basename(__filename),i=t(986).production,c={};let u;u=i.use_env_variable?new o(process.env[i.use_env_variable],i):new o(i.database,i.username,i.password,i),r.readdirSync(__dirname).filter((s=>0!==s.indexOf(".")&&s!==n&&".js"===s.slice(-3))).forEach((s=>{const e=t(524)(a.join(__dirname,s))(u,o.DataTypes);c[e.name]=e})),Object.keys(c).forEach((s=>{c[s].associate&&c[s].associate(c)})),c.sequelize=u,s.exports=c},0:(s,e,t)=>{t(860);const{Router:r}=t(860),a=r(),{StatusCodes:o}=t(10),n=t(613);a.post("/login",n.authenticate),a.post("/register",n.register);const i=t(73);a.get("/users",i.getAll),a.get("/users/:email",i.getByEmail),a.post("/users",i.create),a.put("/users/",i.update),a.get("/",((s,e)=>e.status(o.OK).render("login"))),s.exports=a},529:(s,e,t)=>{const{user:r}=t(44);var a=t(432);const{StatusCodes:o}=t(10);s.exports=new class{async getAll(s,e){try{const s=await r.findAll();return e.status(o.OK).json(s)}catch(s){return console.log(s),e.status(o.INTERNAL_SERVER_ERROR).json(s)}}async getByEmail(s,e){const t=s.body.email;try{const s=await r.findOne({where:{email:t}});return s?e.status(o.OK).json(s):e.status(o.BAD_REQUEST).json({msg:"User not found"})}catch(s){return console.log(s),e.status(o.INTERNAL_SERVER_ERROR).json(s)}}async create(s,e){const{name:t,email:a,password:n,provider:i}=s.body;try{const s=await r.create({name:t,email:a,password:n,provider:i});return e.status(o.OK).json(s)}catch(s){return e.status(o.BAD_REQUEST).json(s)}}async update(s,e){const{name:t,email:n,password:i,provider:c}=s.body;try{const s=await r.findOne({where:{email:n}});if(console.log(s.password_hash),console.log(i),await a.compare(i,s.password_hash))return await s.update({name:t,password:i,provider:c}),e.status(o.OK).json(s);throw new Error("Invalid Password")}catch(s){return console.log(s),e.status(o.BAD_REQUEST).json({error:s})}}}},524:s=>{function e(s){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=524,s.exports=e},432:s=>{"use strict";s.exports=require("bcryptjs")},710:s=>{"use strict";s.exports=require("cookie-parser")},860:s=>{"use strict";s.exports=require("express")},10:s=>{"use strict";s.exports=require("http-status-codes")},344:s=>{"use strict";s.exports=require("jsonwebtoken")},496:s=>{"use strict";s.exports=require("sequelize")},113:s=>{"use strict";s.exports=require("crypto")},147:s=>{"use strict";s.exports=require("fs")},17:s=>{"use strict";s.exports=require("path")},986:s=>{"use strict";s.exports=JSON.parse('{"development":{"username":"postgres","password":"5noSRIdmm@","database":"usuarios","host":"127.0.0.1","dialect":"postgres"}}')}},e={};function t(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return s[r](o,o.exports,t),o.exports}t.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e),(()=>{const s=t(790),{sequelize:e}=t(44),r=8080|process.env.PORT;s.listen(r,(async()=>{console.log(`Server listening at http://localhost:${r}`),await e.authenticate(),console.log("Database connected!")}))})()})();